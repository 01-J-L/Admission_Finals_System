{% extends 'admin_base.html' %}

{% set is_new = not article %}
{% set form_title = 'Add New Article' if is_new else 'Edit Article' %}

{% block title %}{{ form_title }}{% endblock %}

{% block breadcrumb %}
<a href="{{ url_for('auth.admin_manage_content') }}" class="text-gray-500 hover:text-primary">Manage Content</a>
<i class="ri-arrow-right-s-line mx-1 text-gray-400"></i>
<a href="{{ url_for('auth.admin_manage_news') }}" class="text-gray-500 hover:text-primary">News</a>
<i class="ri-arrow-right-s-line mx-1 text-gray-400"></i>
<span>{{ 'Add' if is_new else 'Edit' }}</span>
{% endblock %}

{% block page_title %}{{ form_title }}{% endblock %}

{% block content %}
<form method="POST" enctype="multipart/form-data" class="space-y-6 bg-white p-8 rounded-lg shadow-md">
    
    <div>
        <label for="title" class="block text-sm font-medium leading-6 text-gray-900">Title</label>
        <input type="text" name="title" id="title" value="{{ article.title or '' }}" 
               class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary focus:ring-primary sm:text-sm" required>
    </div>

    <div>
        <label for="publish_date" class="block text-sm font-medium leading-6 text-gray-900">Publish Date</label>
        <input type="date" name="publish_date" id="publish_date" value="{{ article.publish_date.strftime('%Y-%m-%d') if article and article.publish_date else '' }}" 
               class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary focus:ring-primary sm:text-sm">
    </div>

    <div>
        <label for="description" class="block text-sm font-medium leading-6 text-gray-900">Description</label>
        <textarea name="description" id="description" rows="5" 
                  class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary focus:ring-primary sm:text-sm">{{ article.description or '' }}</textarea>
    </div>
    
    <div>
        <label for="read_more_link" class="block text-sm font-medium leading-6 text-gray-900">Read More Link (e.g., Facebook URL)</label>
        <input type="url" name="read_more_link" id="read_more_link" value="{{ article.read_more_link or '' }}" 
               class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary focus:ring-primary sm:text-sm">
    </div>

    <div>
        <label for="image" class="block text-sm font-medium leading-6 text-gray-900">Image</label>
        {% if article and article.image_filename %}
        <div class="mt-2 mb-2 flex items-center gap-x-3">
            <img src="{{ url_for('static', filename='images/uploads/' + article.image_filename) }}" class="h-16 w-32 object-cover rounded-md">
            <span class="text-xs text-gray-500">Current Image. Upload a new one to replace it.</span>
        </div>
        {% endif %}
        <input type="file" name="image" id="image" accept="image/jpeg,image/png,image/webp"
               class="mt-1 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-violet-50 file:text-primary hover:file:bg-violet-100">
    </div>

    <div class="flex items-center justify-end gap-x-6 pt-4 border-t border-gray-200">
        <a href="{{ url_for('auth.admin_manage_news') }}" class="text-sm font-semibold leading-6 text-gray-900">Cancel</a>
        <button type="submit" class="rounded-md bg-primary px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-primary/90">Save Article</button>
    </div>
</form>
{% endblock %}